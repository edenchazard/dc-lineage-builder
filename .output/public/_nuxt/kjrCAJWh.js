import{d as U,r as B,J as me,K as A,y as S,L as tt,C as _,B as C,z as g,D as q,M as nt,N as pe,k as O,O as w,s as ot,P as le,Q as lt,R as st,S as Y,T as it,x as R,U as z,V as se,W as rt,X as at,Y as ge,Z as We,$ as ie,a0 as ct,a1 as ee,a2 as Ce,_ as X,a3 as ut,a4 as ze,a5 as dt,a6 as oe,a7 as ft,a8 as pt,a9 as mt,aa as gt,ab as vt,ac as ne,ad as Se,ae as ve,A as ue,af as ht,g as bt,ag as wt,ah as yt,ai as St,aj as $e,ak as Re,al as xt,am as kt,o as Ct,an as Dt,ao as Tt,ap as Lt,aq as Ee,ar as de}from"#entry";import{f as _t,c as Bt,a as H,r as He,b as he,m as Q,d as De,e as fe,T as J,g as $t,t as Rt,h as Et,D as It,i as Ot,B as Ft,j as At,k as Ie,l as Oe}from"./CrsPpHwL.js";import{I as Nt}from"./C8Q3_mjy.js";import{F as je}from"./C-slQGFS.js";import{u as Ue,L as Mt}from"./Bb4Tddhw.js";import"./5u4QIE9S.js";import"./DhFJ7mD2.js";const Vt=["onClick"],Pt=U({__name:"DialogImport",props:{open:{type:Boolean},id:{}},emits:["close","onImport"],setup(e,{emit:t}){const n=t,o=B(""),l=me("status");function r(){o.value="",l.value?.close(),n("close")}async function s(){if(l.value){try{const i=await nt.json().validate(o.value);return n("onImport",pe(i).tree),!0}catch{l.value.error("Error reading export code. JSON is possibly malformed.")}return!1}}return(i,a)=>(S(),A(tt,{id:i.id,open:i.open,onClose:r},{title:_(()=>[...a[1]||(a[1]=[q("Import lineage",-1)])]),footer:_(({dialog:u})=>[g("button",{class:"dialog-footer-button",onClick:async()=>{await s()&&u.close()}}," Import ",8,Vt)]),default:_(()=>[C(je,{ref_key:"status",ref:l,"global-settings":{showDismiss:!1}},null,512),a[2]||(a[2]=g("div",{class:"flex flex-col"},[g("p",null,"Paste the export text and click 'import'."),g("p",null," If you have a lineage in progress, importing a new lineage will overwrite it. ")],-1)),C(Nt,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=u=>o.value=u),autofocus:"",placeholder:"Paste your import text here",type:"textarea"},null,8,["modelValue"])]),_:1},8,["id","open"]))}}),Wt=Object.assign(Pt,{__name:"DialogImport"});function j(e){return Ge(e)?(e.nodeName||"").toLowerCase():"#document"}function E(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function P(e){var t;return(t=(Ge(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Ge(e){return e instanceof Node||e instanceof E(e).Node}function V(e){return e instanceof Element||e instanceof E(e).Element}function N(e){return e instanceof HTMLElement||e instanceof E(e).HTMLElement}function Fe(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof E(e).ShadowRoot}function ae(e){const{overflow:t,overflowX:n,overflowY:o,display:l}=F(e);return/auto|scroll|overlay|hidden|clip/.test(t+o+n)&&!["inline","contents"].includes(l)}function zt(e){return["table","td","th"].includes(j(e))}function Te(e){const t=Le(),n=F(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(o=>(n.willChange||"").includes(o))||["paint","layout","strict","content"].some(o=>(n.contain||"").includes(o))}function Ht(e){let t=te(e);for(;N(t)&&!be(t);){if(Te(t))return t;t=te(t)}return null}function Le(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function be(e){return["html","body","#document"].includes(j(e))}function F(e){return E(e).getComputedStyle(e)}function we(e){return V(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function te(e){if(j(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Fe(e)&&e.host||P(e);return Fe(t)?t.host:t}function qe(e){const t=te(e);return be(t)?e.ownerDocument?e.ownerDocument.body:e.body:N(t)&&ae(t)?t:qe(t)}function re(e,t,n){var o;t===void 0&&(t=[]),n===void 0&&(n=!0);const l=qe(e),r=l===((o=e.ownerDocument)==null?void 0:o.body),s=E(l);return r?t.concat(s,s.visualViewport||[],ae(l)?l:[],s.frameElement&&n?re(s.frameElement):[]):t.concat(l,re(l,[],n))}function Ke(e){const t=F(e);let n=parseFloat(t.width)||0,o=parseFloat(t.height)||0;const l=N(e),r=l?e.offsetWidth:n,s=l?e.offsetHeight:o,i=he(n)!==r||he(o)!==s;return i&&(n=r,o=s),{width:n,height:o,$:i}}function _e(e){return V(e)?e:e.contextElement}function Z(e){const t=_e(e);if(!N(t))return H(1);const n=t.getBoundingClientRect(),{width:o,height:l,$:r}=Ke(t);let s=(r?he(n.width):n.width)/o,i=(r?he(n.height):n.height)/l;return(!s||!Number.isFinite(s))&&(s=1),(!i||!Number.isFinite(i))&&(i=1),{x:s,y:i}}const jt=H(0);function Xe(e){const t=E(e);return!Le()||!t.visualViewport?jt:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Ut(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==E(e)?!1:t}function K(e,t,n,o){t===void 0&&(t=!1),n===void 0&&(n=!1);const l=e.getBoundingClientRect(),r=_e(e);let s=H(1);t&&(o?V(o)&&(s=Z(o)):s=Z(e));const i=Ut(r,n,o)?Xe(r):H(0);let a=(l.left+i.x)/s.x,u=(l.top+i.y)/s.y,f=l.width/s.x,h=l.height/s.y;if(r){const b=E(r),D=o&&V(o)?E(o):o;let T=b.frameElement;for(;T&&o&&D!==b;){const y=Z(T),$=T.getBoundingClientRect(),x=F(T),d=$.left+(T.clientLeft+parseFloat(x.paddingLeft))*y.x,v=$.top+(T.clientTop+parseFloat(x.paddingTop))*y.y;a*=y.x,u*=y.y,f*=y.x,h*=y.y,a+=d,u+=v,T=E(T).frameElement}}return He({width:f,height:h,x:a,y:u})}function Gt(e){let{rect:t,offsetParent:n,strategy:o}=e;const l=N(n),r=P(n);if(n===r)return t;let s={scrollLeft:0,scrollTop:0},i=H(1);const a=H(0);if((l||!l&&o!=="fixed")&&((j(n)!=="body"||ae(r))&&(s=we(n)),N(n))){const u=K(n);i=Z(n),a.x=u.x+n.clientLeft,a.y=u.y+n.clientTop}return{width:t.width*i.x,height:t.height*i.y,x:t.x*i.x-s.scrollLeft*i.x+a.x,y:t.y*i.y-s.scrollTop*i.y+a.y}}function qt(e){return Array.from(e.getClientRects())}function Ye(e){return K(P(e)).left+we(e).scrollLeft}function Kt(e){const t=P(e),n=we(e),o=e.ownerDocument.body,l=Q(t.scrollWidth,t.clientWidth,o.scrollWidth,o.clientWidth),r=Q(t.scrollHeight,t.clientHeight,o.scrollHeight,o.clientHeight);let s=-n.scrollLeft+Ye(e);const i=-n.scrollTop;return F(o).direction==="rtl"&&(s+=Q(t.clientWidth,o.clientWidth)-l),{width:l,height:r,x:s,y:i}}function Xt(e,t){const n=E(e),o=P(e),l=n.visualViewport;let r=o.clientWidth,s=o.clientHeight,i=0,a=0;if(l){r=l.width,s=l.height;const u=Le();(!u||u&&t==="fixed")&&(i=l.offsetLeft,a=l.offsetTop)}return{width:r,height:s,x:i,y:a}}function Yt(e,t){const n=K(e,!0,t==="fixed"),o=n.top+e.clientTop,l=n.left+e.clientLeft,r=N(e)?Z(e):H(1),s=e.clientWidth*r.x,i=e.clientHeight*r.y,a=l*r.x,u=o*r.y;return{width:s,height:i,x:a,y:u}}function Ae(e,t,n){let o;if(t==="viewport")o=Xt(e,n);else if(t==="document")o=Kt(P(e));else if(V(t))o=Yt(t,n);else{const l=Xe(e);o={...t,x:t.x-l.x,y:t.y-l.y}}return He(o)}function Je(e,t){const n=te(e);return n===t||!V(n)||be(n)?!1:F(n).position==="fixed"||Je(n,t)}function Jt(e,t){const n=t.get(e);if(n)return n;let o=re(e,[],!1).filter(i=>V(i)&&j(i)!=="body"),l=null;const r=F(e).position==="fixed";let s=r?te(e):e;for(;V(s)&&!be(s);){const i=F(s),a=Te(s);!a&&i.position==="fixed"&&(l=null),(r?!a&&!l:!a&&i.position==="static"&&!!l&&["absolute","fixed"].includes(l.position)||ae(s)&&!a&&Je(e,s))?o=o.filter(f=>f!==s):l=i,s=te(s)}return t.set(e,o),o}function Qt(e){let{element:t,boundary:n,rootBoundary:o,strategy:l}=e;const s=[...n==="clippingAncestors"?Jt(t,this._c):[].concat(n),o],i=s[0],a=s.reduce((u,f)=>{const h=Ae(t,f,l);return u.top=Q(h.top,u.top),u.right=De(h.right,u.right),u.bottom=De(h.bottom,u.bottom),u.left=Q(h.left,u.left),u},Ae(t,i,l));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function Zt(e){const{width:t,height:n}=Ke(e);return{width:t,height:n}}function en(e,t,n){const o=N(t),l=P(t),r=n==="fixed",s=K(e,!0,r,t);let i={scrollLeft:0,scrollTop:0};const a=H(0);if(o||!o&&!r)if((j(t)!=="body"||ae(l))&&(i=we(t)),o){const u=K(t,!0,r,t);a.x=u.x+t.clientLeft,a.y=u.y+t.clientTop}else l&&(a.x=Ye(l));return{x:s.left+i.scrollLeft-a.x,y:s.top+i.scrollTop-a.y,width:s.width,height:s.height}}function Ne(e,t){return!N(e)||F(e).position==="fixed"?null:t?t(e):e.offsetParent}function Qe(e,t){const n=E(e);if(!N(e))return n;let o=Ne(e,t);for(;o&&zt(o)&&F(o).position==="static";)o=Ne(o,t);return o&&(j(o)==="html"||j(o)==="body"&&F(o).position==="static"&&!Te(o))?n:o||Ht(e)||n}const tn=async function(e){let{reference:t,floating:n,strategy:o}=e;const l=this.getOffsetParent||Qe,r=this.getDimensions;return{reference:en(t,await l(n),o),floating:{x:0,y:0,...await r(n)}}};function nn(e){return F(e).direction==="rtl"}const on={convertOffsetParentRelativeRectToViewportRelativeRect:Gt,getDocumentElement:P,getClippingRect:Qt,getOffsetParent:Qe,getElementRects:tn,getClientRects:qt,getDimensions:Zt,getScale:Z,isElement:V,isRTL:nn};function ln(e,t){let n=null,o;const l=P(e);function r(){clearTimeout(o),n&&n.disconnect(),n=null}function s(i,a){i===void 0&&(i=!1),a===void 0&&(a=1),r();const{left:u,top:f,width:h,height:b}=e.getBoundingClientRect();if(i||t(),!h||!b)return;const D=fe(f),T=fe(l.clientWidth-(u+h)),y=fe(l.clientHeight-(f+b)),$=fe(u),d={rootMargin:-D+"px "+-T+"px "+-y+"px "+-$+"px",threshold:Q(0,De(1,a))||1};let v=!0;function k(L){const W=L[0].intersectionRatio;if(W!==a){if(!v)return s();W?s(!1,W):o=setTimeout(()=>{s(!1,1e-7)},100)}v=!1}try{n=new IntersectionObserver(k,{...d,root:l.ownerDocument})}catch{n=new IntersectionObserver(k,d)}n.observe(e)}return s(!0),r}function sn(e,t,n,o){o===void 0&&(o={});const{ancestorScroll:l=!0,ancestorResize:r=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:a=!1}=o,u=_e(e),f=l||r?[...u?re(u):[],...re(t)]:[];f.forEach(x=>{l&&x.addEventListener("scroll",n,{passive:!0}),r&&x.addEventListener("resize",n)});const h=u&&i?ln(u,n):null;let b=-1,D=null;s&&(D=new ResizeObserver(x=>{let[d]=x;d&&d.target===u&&D&&(D.unobserve(t),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{D&&D.observe(t)})),n()}),u&&!a&&D.observe(u),D.observe(t));let T,y=a?K(e):null;a&&$();function $(){const x=K(e);y&&(x.x!==y.x||x.y!==y.y||x.width!==y.width||x.height!==y.height)&&n(),y=x,T=requestAnimationFrame($)}return n(),()=>{f.forEach(x=>{l&&x.removeEventListener("scroll",n),r&&x.removeEventListener("resize",n)}),h&&h(),D&&D.disconnect(),D=null,a&&cancelAnimationFrame(T)}}const rn=_t,an=(e,t,n)=>{const o=new Map,l={platform:on,...n},r={...l.platform,_c:o};return Bt(e,t,{...l,platform:r})};function Me(e){var t;return(t=e?.$el)!=null?t:e}function Ze(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Ve(e,t){const n=Ze(e);return Math.round(t*n)/n}function cn(e,t,n){n===void 0&&(n={});const o=n.whileElementsMounted,l=O(()=>{var p;return(p=w(n.open))!=null?p:!0}),r=O(()=>w(n.middleware)),s=O(()=>{var p;return(p=w(n.placement))!=null?p:"bottom"}),i=O(()=>{var p;return(p=w(n.strategy))!=null?p:"absolute"}),a=O(()=>{var p;return(p=w(n.transform))!=null?p:!0}),u=O(()=>Me(e.value)),f=O(()=>Me(t.value)),h=B(0),b=B(0),D=B(i.value),T=B(s.value),y=ot({}),$=B(!1),x=O(()=>{const p={position:D.value,left:"0",top:"0"};if(!f.value)return p;const c=Ve(f.value,h.value),M=Ve(f.value,b.value);return a.value?{...p,transform:"translate("+c+"px, "+M+"px)",...Ze(f.value)>=1.5&&{willChange:"transform"}}:{position:D.value,left:c+"px",top:M+"px"}});let d;function v(){u.value==null||f.value==null||an(u.value,f.value,{middleware:r.value,placement:s.value,strategy:i.value}).then(p=>{h.value=p.x,b.value=p.y,D.value=p.strategy,T.value=p.placement,y.value=p.middlewareData,$.value=!0})}function k(){typeof d=="function"&&(d(),d=void 0)}function L(){if(k(),o===void 0){v();return}if(u.value!=null&&f.value!=null){d=o(u.value,f.value,v);return}}function W(){l.value||($.value=!1)}return le([r,s,i],v,{flush:"sync"}),le([u,f],L,{flush:"sync"}),le(l,W,{flush:"sync"}),lt()&&st(k),{x:Y(h),y:Y(b),strategy:Y(D),placement:Y(T),middlewareData:Y(y),isPositioned:Y($),floatingStyles:x,update:v}}const un=["aria-hidden"],dn=U({__name:"ToolbarDropDownMenu",setup(e){const t=B(),n=B(),o=B(!1),{floatingStyles:l}=cn(t,n,{strategy:"fixed",transform:!0,whileElementsMounted:sn,placement:"bottom-start",middleware:[rn({fallbackPlacements:["bottom-end","bottom","top-end","top","right","left"]})]}),{activate:r,deactivate:s}=it(n,{clickOutsideDeactivates:!0,onActivate(){o.value=!0},onDeactivate(){o.value=!1},isKeyBackward(i){return i.key==="ArrowUp"},isKeyForward(i){return i.key==="ArrowDown"}});return le(o,async i=>{await Ce(),i?r():s()}),(i,a)=>(S(),R(z,null,[C(J,se({ref_key:"button",ref:t,"aria-haspopup":"true","aria-expanded":o.value,class:{selected:o.value}},i.$attrs,{onClick:a[0]||(a[0]=u=>o.value=!0)}),null,16,["aria-expanded","class"]),(S(),A(rt,{to:"body"},[C(at,{name:"fade",mode:"out-in"},{default:_(()=>[o.value?(S(),R("div",{key:0,ref_key:"menu",ref:n,style:ct(w(l)),role:"menu",class:"menu","aria-hidden":!o.value,onKeydown:a[1]||(a[1]=We(ie(u=>o.value=!1,["prevent"]),["tab"]))},[ee(i.$slots,"default",{},void 0,!0)],44,un)):ge("",!0)]),_:3})]))],64))}}),Pe=Object.assign(X(dn,[["__scopeId","data-v-7b6fe297"]]),{__name:"ToolbarDropDownMenu"}),fn=U({__name:"ToolbarDropDownMenuItem",props:{as:{default:"button"}},setup(e){return(t,n)=>(S(),A(ut(t.as),se({type:t.as==="button"?"button":null},t.$attrs,{class:"menu-item",role:"menuitem"}),{default:_(()=>[ee(t.$slots,"default",{},void 0,!0)]),_:3},16,["type"]))}}),xe=Object.assign(X(fn,[["__scopeId","data-v-d349a1b8"]]),{__name:"ToolbarDropDownMenuItem"}),pn={},mn={class:"group"},gn={class:"buttons"},vn={key:0,class:"legend"};function hn(e,t){return S(),R("div",mn,[g("div",gn,[ee(e.$slots,"default",{},void 0,!0)]),e.$slots.legend?(S(),R("span",vn,[ee(e.$slots,"legend",{},void 0,!0)])):ge("",!0)])}const ke=Object.assign(X(pn,[["render",hn],["__scopeId","data-v-212fbbdf"]]),{__name:"ToolbarGroup"}),bn={class:"settings","aria-label":"Settings toolbar"},wn=["checked"],yn=["checked"],Sn={class:"functions","aria-label":"Functions toolbar"},xn=["checked"],kn=["checked"],Cn={class:"selection-apply-breed-container"},Dn=["disabled"],Tn=U({__name:"LineageBuilderToolbar",props:{config:{type:Object,required:!0},tree:{type:Object,required:!0}},emits:["addParents","switchParents","unselectAll","displayNames","displayCodes","randomizeLabels","deleteAncestors","importTree","changeBreed","selectCriteria","fullscreen","undo","redo","updateConfig"],setup(e,{emit:t}){const n=B(),o=B(),l=B(),r=B(!1),s=B(!1),i=ze();dt(l,p=>{const c=p[0];r.value=c.target.clientWidth===l.value.scrollWidth});const a=oe([{title:"Export dragon",icon:"save",label:"Export",click:()=>h.showExportDialog=!0},{title:"Import dragon",icon:"file-code",label:"Import",click:()=>h.showImportDialog=!0},{title:"Get Link",icon:"link",label:"Get Link",click:()=>h.showGenerateDialog=!0},{title:"Toggle fullscreen",icon:"maximize",label:"Fullscreen",click:()=>b("fullscreen")},{title:"Undo",icon:"undo",label:"Undo",click:()=>b("undo"),disabled:O(()=>!i.treeHistory.canUndo)},{title:"Redo",icon:"redo",label:"Redo",click:()=>b("redo"),disabled:O(()=>!i.treeHistory.canRedo)}].map(p=>L(p,"2x"))),u=oe([{name:"Labels",buttons:[{title:"Show names",icon:"font",label:"Names",click:()=>b("displayNames")},{title:"Display codes",icon:"italic",label:"Codes",click:()=>b("displayCodes")},{title:"Randomise visible label",icon:"random",label:"Randomise label",click:()=>b("randomizeLabels")}]},{name:"Parents",buttons:[{title:"Delete Parents and Ancestors",icon:"minus",label:"Delete Parents",click:()=>b("deleteAncestors")},{title:"Add parents",icon:"arrow-right",label:"Add parents",click:()=>b("addParents")},{title:"Switch parents",icon:"sync-alt",label:"switch parents",click:()=>b("switchParents")}]}].map(p=>({name:p.name,buttons:p.buttons.map(c=>L(c,"1x"))}))),f=oe([{label:"All with code",key:"display",criteria:1},{label:"All with name",key:"display",criteria:0},{label:"All with placeholder",key:"breed",criteria:"Placeholder"}]),h=oe({showImportDialog:!1,showExportDialog:!1,showGenerateDialog:!1}),b=t,D=p=>{let c=!1,M=!1;return p.every(m=>{m.selected&&(m.gender==="m"?c=!0:m.gender==="f"&&(M=!0))}),{male:c,female:M}},T=B(ft.name),y=O(()=>i.selectionCount),$=O(()=>{if(!y.value)return[];const{male:p,female:c}=D(i.activeLineage),M=$t(pt,Rt(Et)),m=I=>I.name,G=mt.map(m),Be=gt.map(m);let ye;const ce=(I,et)=>I.includes(et);return p&&c?ye=I=>ce(G,I.name)&&ce(Be,I.name):ye=p?I=>ce(G,I.name):I=>ce(Be,I.name),M.filter(ye).map(I=>I.name)});function x(p){b("importTree",p)}function d(){l.value.scrollLeft=0}function v(){l.value.scrollLeft=l.value.scrollWidth}function k(p,c){b("updateConfig",p,c)}function L(p,c="2x"){return{...p,title:W(p.title),label:W(p.label),icon:{size:c,icon:p.icon}}}function W(p){return p.split(" ").map(c=>c[0].toUpperCase()+c.slice(1)).join(" ")}return(p,c)=>{const M=vt("dragscroll");return S(),R(z,null,[C(It,{id:"dialog-export",open:h.showExportDialog,tree:e.tree,onClose:c[0]||(c[0]=m=>h.showExportDialog=!1)},null,8,["open","tree"]),C(Wt,{id:"dialog-import",open:h.showImportDialog,onClose:c[1]||(c[1]=m=>h.showImportDialog=!1),onOnImport:x},null,8,["open"]),C(Ot,{id:"dialog-generate",open:h.showGenerateDialog,tree:e.tree,onClose:c[2]||(c[2]=m=>h.showGenerateDialog=!1)},null,8,["open","tree"]),g("div",se({ref_key:"toolbar",ref:n,class:"toolbar",role:"toolbar"},p.$attrs),[g("div",bn,[g("input",{id:"show-interface",checked:e.config.showInterface,class:"item",type:"checkbox",onChange:c[3]||(c[3]=m=>k("showInterface",m.target.checked))},null,40,wn),c[17]||(c[17]=g("label",{for:"show-interface"},"Show controls",-1)),g("input",{id:"show-labels",checked:e.config.showLabels,class:"item",type:"checkbox",onChange:c[4]||(c[4]=m=>k("showLabels",m.target.checked))},null,40,yn),c[18]||(c[18]=g("label",{for:"show-labels"},"Show labels",-1))]),g("div",Sn,[(S(!0),R(z,null,ne(a,m=>(S(),A(J,se({key:m.label},{ref_for:!0},m,{onClick:m.click}),null,16,["onClick"]))),128)),C(Pe,{icon:{icon:"cog",size:"2x"},title:"Settings",label:"Settings"},{default:_(()=>[C(xe,{as:"div",onClick:c[6]||(c[6]=m=>k("showInterface",!e.config.showInterface))},{default:_(()=>[g("input",{id:"show-interface2",checked:e.config.showInterface,type:"checkbox"},null,8,xn),g("label",{for:"show-interface2",onClick:c[5]||(c[5]=ie(()=>{},["prevent"]))},"Show controls")]),_:1}),C(xe,{as:"div",onClick:c[8]||(c[8]=m=>k("showLabels",!e.config.showLabels))},{default:_(()=>[g("input",{id:"show-labels2",checked:e.config.showLabels,type:"checkbox"},null,8,kn),g("label",{for:"show-labels2",onClick:c[7]||(c[7]=ie(()=>{},["prevent"]))},"Show labels")]),_:1})]),_:1})]),g("div",{class:Se(["selection-tools",{"full-width":r.value}]),"aria-label":"Selection toolbar"},[g("button",{class:Se(["selection-nav left",{invisible:r.value}]),type:"button",title:"Scroll to start",onClick:d},null,2),ve((S(),R("div",{ref_key:"selectionToolsScrollArea",ref:l,class:"selection-scrollable",onDragscrollstart:c[15]||(c[15]=m=>s.value=!0),onDragscrollend:c[16]||(c[16]=m=>s.value=!1)},[C(ke,null,{legend:_(()=>[...c[19]||(c[19]=[q("Select",-1)])]),default:_(()=>[C(J,{title:"Select all males",icon:{icon:"mars"},onClick:c[9]||(c[9]=m=>b("selectCriteria","gender","m"))}),C(J,{icon:{icon:"venus"},title:"Select all females",onClick:c[10]||(c[10]=m=>b("selectCriteria","gender","f"))}),C(Pe,{title:"More options",icon:{icon:"caret-down"}},{default:_(()=>[(S(!0),R(z,null,ne(f,m=>(S(),A(xe,{key:m.key,onClick:G=>b("selectCriteria",m.key,m.criteria)},{default:_(()=>[q(ue(m.label),1)]),_:2},1032,["onClick"]))),128))]),_:1}),C(J,{title:"Unselect all",icon:{icon:"times"},disabled:y.value===0,onClick:c[11]||(c[11]=m=>b("unselectAll"))},null,8,["disabled"])]),_:1}),C(ke,null,{legend:_(()=>[...c[21]||(c[21]=[q("Breed",-1)])]),default:_(()=>[g("div",Cn,[ve(g("select",{id:"selection-apply-breed",ref_key:"breedSelector",ref:o,"onUpdate:modelValue":c[12]||(c[12]=m=>T.value=m),title:"Apply selected breed",class:"breed-dropdown interactive","data-no-dragscroll":"",disabled:y.value===0,"aria-labelledby":"selection-apply-breed selection-apply-count ",onChange:c[13]||(c[13]=m=>b("changeBreed",T.value))},[(S(!0),R(z,null,ne($.value,m=>(S(),R("option",{key:m},ue(m),1))),128))],40,Dn),[[ht,T.value]]),g("span",{id:"selection-apply-count",title:"Dragons selected",class:"count",onClick:c[14]||(c[14]=m=>o.value?.focus())},[q(ue(y.value),1),c[20]||(c[20]=g("span",{class:"sr-only"},"selected",-1))])])]),_:1}),(S(!0),R(z,null,ne(u,m=>(S(),A(ke,{key:m.name},{legend:_(()=>[q(ue(m.name),1)]),default:_(()=>[(S(!0),R(z,null,ne(m.buttons,G=>(S(),A(J,se({key:G.label},{ref_for:!0},G,{disabled:y.value===0,onClick:G.click}),null,16,["disabled","onClick"]))),128))]),_:2},1024))),128))],32)),[[M,void 0,void 0,{x:!0}]]),g("button",{class:Se(["selection-nav right",{invisible:r.value}]),type:"button",title:"Scroll to end",onClick:v},null,2)],2)],16)],64)}}}),Ln=Object.assign(X(Tn,[["__scopeId","data-v-4ffaa3f3"]]),{__name:"LineageBuilderToolbar"}),_n={class:"dialog-inner"},Bn={class:"dialog-header"},$n={id:"dialog-breed-selector-wrapper",class:"dialog-header-title"},Rn={class:"dialog-buttons"},En={class:"dialog-main"},In=U({__name:"DialogBreedSelectorWrapper",setup(e){const t=Ue();return(n,o)=>{const l=bt("FontAwesomeIcon");return S(),R("dialog",{id:"breed-selector-wrapper",ref:w(t).dialogRef,class:"dialog no-transition","aria-labelledby":"dialog-breed-selector-wrapper",onClick:o[1]||(o[1]=r=>{w(t).dialogRef.value&&r.target?.isSameNode(w(t).dialogRef.value)&&w(t).hide()})},[g("div",_n,[g("header",Bn,[g("h1",$n,[ee(n.$slots,"title",{},()=>[o[2]||(o[2]=q("Choose a breed",-1))],!0)]),g("div",Rn,[g("button",{class:"button close-button",type:"button",title:"Close",onClick:o[0]||(o[0]=r=>w(t).hide())},[C(l,{size:"2x",icon:"times"})])])]),g("main",En,[ee(n.$slots,"content",{},void 0,!0)])])],512)}}}),On=Object.assign(X(In,[["__scopeId","data-v-83d610bf"]]),{__name:"DialogBreedSelectorWrapper"}),Fn={id:"filtering"},An=U({__name:"DialogBreedSelector",emits:["breedSelected"],setup(e,{emit:t}){const n=t,o=wt("search",""),l=me("mateSearchEl"),r=me("resultsEl"),s=Ue();yt(()=>{l.value&&document.activeElement!==l.value.$el&&l.value.$el.focus()}),le(s.autofocus,async u=>{await Ce(),u&&l.value&&l.value.$el.focus()});function i(u){const f=parseInt(s.dialogRef.value?.dataset.openTime??"0");Date.now()-f<250||(s.handleBreedSelected(u),n("breedSelected",u))}async function a(){await Ce(),r.value&&r.value.querySelector("[tabindex='-1'], .breed-entry-button, .grid-cell")?.focus()}return(u,f)=>(S(),A(On,{onClose:f[3]||(f[3]=h=>w(s).hide())},{content:_(()=>[g("form",{role:"search",onSubmit:f[1]||(f[1]=ie(h=>a(),["prevent"])),onKeydown:f[2]||(f[2]=We(ie(h=>a(),["prevent"]),["enter"]))},[f[6]||(f[6]=g("h2",{class:"sr-only"},"Filtering",-1)),g("div",Fn,[C(Ft,{id:"results-search",ref_key:"mateSearchEl",ref:l,modelValue:w(o),"onUpdate:modelValue":f[0]||(f[0]=h=>St(o)?o.value=h:null),placeholder:"Search",enterkeyhint:"search"},null,8,["modelValue"]),f[4]||(f[4]=g("label",{for:"results-search",class:"sr-only"}," Search ",-1)),f[5]||(f[5]=g("label",{for:"applied-filters",class:"sr-only"}," Filters ",-1)),C(At,{id:"applied-filters",placeholder:"Filters",container:"#breed-selector-wrapper"})])],32),g("section",{id:"breeds",ref_key:"resultsEl",ref:r},[f[7]||(f[7]=g("h2",{class:"sr-only"},"Results",-1)),ve(C(Ie,{id:"filtered-breeds",search:w(o),breeds:w($e)("m"),tags:w(Oe),"no-results-text":"There are no breeds that match this criteria.",onBreedSelected:i},null,8,["search","breeds","tags"]),[[Re,w(s).forGender.value==="m"]]),ve(C(Ie,{id:"filtered-breeds",search:w(o),breeds:w($e)("f"),tags:w(Oe),"no-results-text":"There are no breeds that match this criteria.",onBreedSelected:i},null,8,["search","breeds","tags"]),[[Re,w(s).forGender.value==="f"]])],512)]),_:1}))}}),Nn=Object.assign(X(An,[["__scopeId","data-v-94394480"]]),{__name:"DialogBreedSelector"}),Mn={class:"constrain-width"},Vn=U({__name:"LineageBuilder",setup(e){const t=xt(),n=ze(),o=B(null),l=kt(o),r=oe({showInterface:!0,showLabels:!0,disabled:!1}),s=me("status");Ct(async()=>{if(!s.value)return;const d=t.query.template;if(d!==void 0)try{s.value.info({message:"Loading template... For big lineages, this can take a moment to load.",showDismiss:!1});const v=await Dt(d);s.value.close(()=>{n.activeTree=pe(v.lineage).withMetadata().raw()})}catch(v){if(v instanceof Tt&&v.response?.status===404){s.value.error("The lineage couldn't be found.");return}s.value.error("Sorry, an error has occurred.")}}),Lt(()=>{n.treeHistory.clear()});function i(d){n.activeTree=n.activeLineage.every(d)}function a(d,v){if(typeof d=="string"){const k=d.toString();n.activeTree=n.activeLineage.every(L=>{L.selected&&k in L&&(L[k]=v)})}else if(typeof d=="function"){const k=d;n.activeTree=n.activeLineage.every(L=>{L.selected&&k(L)})}}function u(d,v){if(typeof d=="string"){const k=d.toString();x(L=>L[k]===v)}else typeof d=="function"&&x(d)}function f(d){i(v=>{v.selected&&(v.breed=d)})}function h(){a("parents",{})}function b(){a(d=>{Ee(d)||(d.parents={m:de.createWithMetadata({gender:"m"}),f:de.createWithMetadata({gender:"f"})})})}function D(){a(d=>{Ee(d)&&Object.assign(d,pe(d).switchParents().raw())})}function T(){a(d=>{d.display===0?d.name=de.generateName():d.code=de.generateCode()})}function y(d){a("display",d)}function $(){a("selected",!1)}function x(d){i(v=>{!v.selected&&d(v)&&(v.selected=!0)})}return(d,v)=>(S(),R("div",{ref_key:"builder",ref:o,class:"builder-container"},[C(Nn),g("div",Mn,[C(je,{ref_key:"status",ref:s},null,512)]),w(n).activeTree!==null?(S(),A(Mt,{key:0,class:"builder",root:w(n).activeTree,config:r,onContextmenu:()=>!1},null,8,["root","config"])):ge("",!0),w(n).activeTree!==null?(S(),A(Ln,{key:1,config:r,tree:w(n).activeTree,onUpdateConfig:v[0]||(v[0]=(k,L)=>r[k]=L),onImportTree:v[1]||(v[1]=k=>w(n).activeTree=w(pe)(k).withMetadata().tree),onUnselectAll:$,onChangeBreed:f,onDisplayNames:v[2]||(v[2]=k=>y(0)),onDisplayCodes:v[3]||(v[3]=k=>y(1)),onSelectCriteria:u,onRandomizeLabels:T,onDeleteAncestors:h,onAddParents:b,onSwitchParents:D,onFullscreen:w(l).toggle,onUndo:w(n).treeHistory.undo,onRedo:w(n).treeHistory.redo},null,8,["config","tree","onFullscreen","onUndo","onRedo"])):ge("",!0)],512))}}),Pn=Object.assign(X(Vn,[["__scopeId","data-v-a232de98"]]),{__name:"LineageBuilder"}),Kn=U({__name:"Builder",setup(e){return(t,n)=>(S(),R(z,null,[n[0]||(n[0]=g("h1",{class:"sr-only"},"Build",-1)),C(Pn)],64))}});export{Kn as default};
