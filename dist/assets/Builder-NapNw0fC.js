import{d as W,r as _,u as he,o as x,b as N,w as L,e as K,a as d,f as C,g as lt,h as st,L as ve,i as I,j as h,s as it,k as se,l as rt,m as at,n as Y,p as ct,q as De,c as R,t as ie,v as ut,x as Ue,y as re,z as ee,A as ae,T as dt,B as ft,F as U,_ as q,C as pt,D as Ge,E as mt,G as le,H as gt,I as vt,J as ht,K as bt,M as wt,N as oe,O as xe,P as te,Q as fe,R as yt,S as St,U as Be,V as xt,W as Ct,X as kt,Y as Ee,Z as Fe,$ as Dt,a0 as Tt,a1 as $t,a2 as Lt,a3 as Rt,a4 as _t,a5 as Ie,a6 as pe}from"./index-CkVLQWri.js";import{f as Bt,c as G,r as je,a as be,b as me,d as Et,m as Q,e as Te,T as J,g as Ft,t as It,_ as At,h as Ot,i as Nt,j as Vt,k as Ae,l as ge,B as Mt,n as Pt,o as Oe,p as Ne}from"./BreedListFilterDropdown-C6Npfuqk.js";import{I as Wt}from"./InputTextbox-10S61aZ7.js";import{F as qe}from"./FeedbackPanel-DWRWo6y_.js";import{u as Ke,L as zt}from"./LineageView-BQ2nDoQ3.js";import"./DragonPortrait-D5BSQTBz.js";import"./LineageWrapper-D2uaZU0p.js";const Ht=["onClick"],Ut=W({__name:"DialogImport",props:{open:{type:Boolean},id:{}},emits:["close","onImport"],setup(e,{emit:n}){const t=n,o=_(""),l=he("status");function r(){var i;o.value="",(i=l.value)==null||i.close(),t("close")}async function s(){if(l.value){try{const i=await st.json().validate(o.value);return t("onImport",ve(i).tree),!0}catch{l.value.error("Error reading export code. JSON is possibly malformed.")}return!1}}return(i,a)=>(x(),N(lt,{id:i.id,open:i.open,onClose:r},{title:L(()=>a[1]||(a[1]=[K("Import lineage")])),footer:L(({dialog:u})=>[d("button",{class:"dialog-footer-button",onClick:async()=>{await s()&&u.close()}}," Import ",8,Ht)]),default:L(()=>[C(qe,{ref_key:"status",ref:l,"global-settings":{showDismiss:!1}},null,512),a[2]||(a[2]=d("div",{class:"flex flex-col"},[d("p",null,"Paste the export text and click 'import'."),d("p",null," If you have a lineage in progress, importing a new lineage will overwrite it. ")],-1)),C(Wt,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=u=>o.value=u),autofocus:"",placeholder:"Paste your import text here",type:"textarea"},null,8,["modelValue"])]),_:1},8,["id","open"]))}});function j(e){return Xe(e)?(e.nodeName||"").toLowerCase():"#document"}function E(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function z(e){var n;return(n=(Xe(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function Xe(e){return e instanceof Node||e instanceof E(e).Node}function P(e){return e instanceof Element||e instanceof E(e).Element}function V(e){return e instanceof HTMLElement||e instanceof E(e).HTMLElement}function Ve(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof E(e).ShadowRoot}function ue(e){const{overflow:n,overflowX:t,overflowY:o,display:l}=A(e);return/auto|scroll|overlay|hidden|clip/.test(n+o+t)&&!["inline","contents"].includes(l)}function Gt(e){return["table","td","th"].includes(j(e))}function $e(e){const n=Le(),t=A(e);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(o=>(t.willChange||"").includes(o))||["paint","layout","strict","content"].some(o=>(t.contain||"").includes(o))}function jt(e){let n=ne(e);for(;V(n)&&!we(n);){if($e(n))return n;n=ne(n)}return null}function Le(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function we(e){return["html","body","#document"].includes(j(e))}function A(e){return E(e).getComputedStyle(e)}function ye(e){return P(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function ne(e){if(j(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Ve(e)&&e.host||z(e);return Ve(n)?n.host:n}function Ye(e){const n=ne(e);return we(n)?e.ownerDocument?e.ownerDocument.body:e.body:V(n)&&ue(n)?n:Ye(n)}function ce(e,n,t){var o;n===void 0&&(n=[]),t===void 0&&(t=!0);const l=Ye(e),r=l===((o=e.ownerDocument)==null?void 0:o.body),s=E(l);return r?n.concat(s,s.visualViewport||[],ue(l)?l:[],s.frameElement&&t?ce(s.frameElement):[]):n.concat(l,ce(l,[],t))}function Je(e){const n=A(e);let t=parseFloat(n.width)||0,o=parseFloat(n.height)||0;const l=V(e),r=l?e.offsetWidth:t,s=l?e.offsetHeight:o,i=be(t)!==r||be(o)!==s;return i&&(t=r,o=s),{width:t,height:o,$:i}}function Re(e){return P(e)?e:e.contextElement}function Z(e){const n=Re(e);if(!V(n))return G(1);const t=n.getBoundingClientRect(),{width:o,height:l,$:r}=Je(n);let s=(r?be(t.width):t.width)/o,i=(r?be(t.height):t.height)/l;return(!s||!Number.isFinite(s))&&(s=1),(!i||!Number.isFinite(i))&&(i=1),{x:s,y:i}}const qt=G(0);function Qe(e){const n=E(e);return!Le()||!n.visualViewport?qt:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Kt(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==E(e)?!1:n}function X(e,n,t,o){n===void 0&&(n=!1),t===void 0&&(t=!1);const l=e.getBoundingClientRect(),r=Re(e);let s=G(1);n&&(o?P(o)&&(s=Z(o)):s=Z(e));const i=Kt(r,t,o)?Qe(r):G(0);let a=(l.left+i.x)/s.x,u=(l.top+i.y)/s.y,p=l.width/s.x,v=l.height/s.y;if(r){const w=E(r),D=o&&P(o)?E(o):o;let T=w.frameElement;for(;T&&o&&D!==w;){const S=Z(T),B=T.getBoundingClientRect(),k=A(T),f=B.left+(T.clientLeft+parseFloat(k.paddingLeft))*S.x,b=B.top+(T.clientTop+parseFloat(k.paddingTop))*S.y;a*=S.x,u*=S.y,p*=S.x,v*=S.y,a+=f,u+=b,T=E(T).frameElement}}return je({width:p,height:v,x:a,y:u})}function Xt(e){let{rect:n,offsetParent:t,strategy:o}=e;const l=V(t),r=z(t);if(t===r)return n;let s={scrollLeft:0,scrollTop:0},i=G(1);const a=G(0);if((l||!l&&o!=="fixed")&&((j(t)!=="body"||ue(r))&&(s=ye(t)),V(t))){const u=X(t);i=Z(t),a.x=u.x+t.clientLeft,a.y=u.y+t.clientTop}return{width:n.width*i.x,height:n.height*i.y,x:n.x*i.x-s.scrollLeft*i.x+a.x,y:n.y*i.y-s.scrollTop*i.y+a.y}}function Yt(e){return Array.from(e.getClientRects())}function Ze(e){return X(z(e)).left+ye(e).scrollLeft}function Jt(e){const n=z(e),t=ye(e),o=e.ownerDocument.body,l=Q(n.scrollWidth,n.clientWidth,o.scrollWidth,o.clientWidth),r=Q(n.scrollHeight,n.clientHeight,o.scrollHeight,o.clientHeight);let s=-t.scrollLeft+Ze(e);const i=-t.scrollTop;return A(o).direction==="rtl"&&(s+=Q(n.clientWidth,o.clientWidth)-l),{width:l,height:r,x:s,y:i}}function Qt(e,n){const t=E(e),o=z(e),l=t.visualViewport;let r=o.clientWidth,s=o.clientHeight,i=0,a=0;if(l){r=l.width,s=l.height;const u=Le();(!u||u&&n==="fixed")&&(i=l.offsetLeft,a=l.offsetTop)}return{width:r,height:s,x:i,y:a}}function Zt(e,n){const t=X(e,!0,n==="fixed"),o=t.top+e.clientTop,l=t.left+e.clientLeft,r=V(e)?Z(e):G(1),s=e.clientWidth*r.x,i=e.clientHeight*r.y,a=l*r.x,u=o*r.y;return{width:s,height:i,x:a,y:u}}function Me(e,n,t){let o;if(n==="viewport")o=Qt(e,t);else if(n==="document")o=Jt(z(e));else if(P(n))o=Zt(n,t);else{const l=Qe(e);o={...n,x:n.x-l.x,y:n.y-l.y}}return je(o)}function et(e,n){const t=ne(e);return t===n||!P(t)||we(t)?!1:A(t).position==="fixed"||et(t,n)}function en(e,n){const t=n.get(e);if(t)return t;let o=ce(e,[],!1).filter(i=>P(i)&&j(i)!=="body"),l=null;const r=A(e).position==="fixed";let s=r?ne(e):e;for(;P(s)&&!we(s);){const i=A(s),a=$e(s);!a&&i.position==="fixed"&&(l=null),(r?!a&&!l:!a&&i.position==="static"&&!!l&&["absolute","fixed"].includes(l.position)||ue(s)&&!a&&et(e,s))?o=o.filter(p=>p!==s):l=i,s=ne(s)}return n.set(e,o),o}function tn(e){let{element:n,boundary:t,rootBoundary:o,strategy:l}=e;const s=[...t==="clippingAncestors"?en(n,this._c):[].concat(t),o],i=s[0],a=s.reduce((u,p)=>{const v=Me(n,p,l);return u.top=Q(v.top,u.top),u.right=Te(v.right,u.right),u.bottom=Te(v.bottom,u.bottom),u.left=Q(v.left,u.left),u},Me(n,i,l));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function nn(e){const{width:n,height:t}=Je(e);return{width:n,height:t}}function on(e,n,t){const o=V(n),l=z(n),r=t==="fixed",s=X(e,!0,r,n);let i={scrollLeft:0,scrollTop:0};const a=G(0);if(o||!o&&!r)if((j(n)!=="body"||ue(l))&&(i=ye(n)),o){const u=X(n,!0,r,n);a.x=u.x+n.clientLeft,a.y=u.y+n.clientTop}else l&&(a.x=Ze(l));return{x:s.left+i.scrollLeft-a.x,y:s.top+i.scrollTop-a.y,width:s.width,height:s.height}}function Pe(e,n){return!V(e)||A(e).position==="fixed"?null:n?n(e):e.offsetParent}function tt(e,n){const t=E(e);if(!V(e))return t;let o=Pe(e,n);for(;o&&Gt(o)&&A(o).position==="static";)o=Pe(o,n);return o&&(j(o)==="html"||j(o)==="body"&&A(o).position==="static"&&!$e(o))?t:o||jt(e)||t}const ln=async function(e){let{reference:n,floating:t,strategy:o}=e;const l=this.getOffsetParent||tt,r=this.getDimensions;return{reference:on(n,await l(t),o),floating:{x:0,y:0,...await r(t)}}};function sn(e){return A(e).direction==="rtl"}const rn={convertOffsetParentRelativeRectToViewportRelativeRect:Xt,getDocumentElement:z,getClippingRect:tn,getOffsetParent:tt,getElementRects:ln,getClientRects:Yt,getDimensions:nn,getScale:Z,isElement:P,isRTL:sn};function an(e,n){let t=null,o;const l=z(e);function r(){clearTimeout(o),t&&t.disconnect(),t=null}function s(i,a){i===void 0&&(i=!1),a===void 0&&(a=1),r();const{left:u,top:p,width:v,height:w}=e.getBoundingClientRect();if(i||n(),!v||!w)return;const D=me(p),T=me(l.clientWidth-(u+v)),S=me(l.clientHeight-(p+w)),B=me(u),f={rootMargin:-D+"px "+-T+"px "+-S+"px "+-B+"px",threshold:Q(0,Te(1,a))||1};let b=!0;function y($){const H=$[0].intersectionRatio;if(H!==a){if(!b)return s();H?s(!1,H):o=setTimeout(()=>{s(!1,1e-7)},100)}b=!1}try{t=new IntersectionObserver(y,{...f,root:l.ownerDocument})}catch{t=new IntersectionObserver(y,f)}t.observe(e)}return s(!0),r}function cn(e,n,t,o){o===void 0&&(o={});const{ancestorScroll:l=!0,ancestorResize:r=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:a=!1}=o,u=Re(e),p=l||r?[...u?ce(u):[],...ce(n)]:[];p.forEach(k=>{l&&k.addEventListener("scroll",t,{passive:!0}),r&&k.addEventListener("resize",t)});const v=u&&i?an(u,t):null;let w=-1,D=null;s&&(D=new ResizeObserver(k=>{let[f]=k;f&&f.target===u&&D&&(D.unobserve(n),cancelAnimationFrame(w),w=requestAnimationFrame(()=>{D&&D.observe(n)})),t()}),u&&!a&&D.observe(u),D.observe(n));let T,S=a?X(e):null;a&&B();function B(){const k=X(e);S&&(k.x!==S.x||k.y!==S.y||k.width!==S.width||k.height!==S.height)&&t(),S=k,T=requestAnimationFrame(B)}return t(),()=>{p.forEach(k=>{l&&k.removeEventListener("scroll",t),r&&k.removeEventListener("resize",t)}),v&&v(),D&&D.disconnect(),D=null,a&&cancelAnimationFrame(T)}}const un=Bt,dn=(e,n,t)=>{const o=new Map,l={platform:rn,...t},r={...l.platform,_c:o};return Et(e,n,{...l,platform:r})};function We(e){var n;return(n=e==null?void 0:e.$el)!=null?n:e}function nt(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ze(e,n){const t=nt(e);return Math.round(n*t)/t}function fn(e,n,t){t===void 0&&(t={});const o=t.whileElementsMounted,l=I(()=>{var m;return(m=h(t.open))!=null?m:!0}),r=I(()=>h(t.middleware)),s=I(()=>{var m;return(m=h(t.placement))!=null?m:"bottom"}),i=I(()=>{var m;return(m=h(t.strategy))!=null?m:"absolute"}),a=I(()=>{var m;return(m=h(t.transform))!=null?m:!0}),u=I(()=>We(e.value)),p=I(()=>We(n.value)),v=_(0),w=_(0),D=_(i.value),T=_(s.value),S=it({}),B=_(!1),k=I(()=>{const m={position:D.value,left:"0",top:"0"};if(!p.value)return m;const c=ze(p.value,v.value),M=ze(p.value,w.value);return a.value?{...m,transform:"translate("+c+"px, "+M+"px)",...nt(p.value)>=1.5&&{willChange:"transform"}}:{position:D.value,left:c+"px",top:M+"px"}});let f;function b(){u.value==null||p.value==null||dn(u.value,p.value,{middleware:r.value,placement:s.value,strategy:i.value}).then(m=>{v.value=m.x,w.value=m.y,D.value=m.strategy,T.value=m.placement,S.value=m.middlewareData,B.value=!0})}function y(){typeof f=="function"&&(f(),f=void 0)}function $(){if(y(),o===void 0){b();return}if(u.value!=null&&p.value!=null){f=o(u.value,p.value,b);return}}function H(){l.value||(B.value=!1)}return se([r,s,i],b,{flush:"sync"}),se([u,p],$,{flush:"sync"}),se(l,H,{flush:"sync"}),rt()&&at(y),{x:Y(v),y:Y(w),strategy:Y(D),placement:Y(T),middlewareData:Y(S),isPositioned:Y(B),floatingStyles:k,update:b}}const pn=["aria-hidden"],mn=W({__name:"ToolbarDropDownMenu",setup(e){const n=_(),t=_(),o=_(!1),{floatingStyles:l}=fn(n,t,{strategy:"fixed",transform:!0,whileElementsMounted:cn,placement:"bottom-start",middleware:[un({fallbackPlacements:["bottom-end","bottom","top-end","top","right","left"]})]}),{activate:r,deactivate:s}=ct(t,{clickOutsideDeactivates:!0,onActivate(){o.value=!0},onDeactivate(){o.value=!1},isKeyBackward(i){return i.key==="ArrowUp"},isKeyForward(i){return i.key==="ArrowDown"}});return se(o,async i=>{await De(),i?r():s()}),(i,a)=>(x(),R(U,null,[C(J,ie({ref_key:"button",ref:n,"aria-haspopup":"true","aria-expanded":o.value,class:{selected:o.value}},i.$attrs,{onClick:a[0]||(a[0]=u=>o.value=!0)}),null,16,["aria-expanded","class"]),(x(),N(ft,{to:"body"},[C(dt,{name:"fade",mode:"out-in"},{default:L(()=>[o.value?(x(),R("div",{key:0,ref_key:"menu",ref:t,style:ut(h(l)),role:"menu",class:"menu","aria-hidden":!o.value,onKeydown:a[1]||(a[1]=Ue(re(u=>o.value=!1,["prevent"]),["tab"]))},[ee(i.$slots,"default",{},void 0,!0)],44,pn)):ae("",!0)]),_:3})]))],64))}}),He=q(mn,[["__scopeId","data-v-7b6fe297"]]),gn=W({__name:"ToolbarDropDownMenuItem",props:{as:{default:"button"}},setup(e){return(n,t)=>(x(),N(pt(n.as),ie({type:n.as==="button"?"button":null},n.$attrs,{class:"menu-item",role:"menuitem"}),{default:L(()=>[ee(n.$slots,"default",{},void 0,!0)]),_:3},16,["type"]))}}),Ce=q(gn,[["__scopeId","data-v-d349a1b8"]]),vn={},hn={class:"group"},bn={class:"buttons"},wn={key:0,class:"legend"};function yn(e,n){return x(),R("div",hn,[d("div",bn,[ee(e.$slots,"default",{},void 0,!0)]),e.$slots.legend?(x(),R("span",wn,[ee(e.$slots,"legend",{},void 0,!0)])):ae("",!0)])}const ke=q(vn,[["render",yn],["__scopeId","data-v-212fbbdf"]]),Sn={class:"settings","aria-label":"Settings toolbar"},xn=["checked"],Cn=["checked"],kn={class:"functions","aria-label":"Functions toolbar"},Dn=["checked"],Tn=["checked"],$n={class:"selection-apply-breed-container"},Ln=["disabled"],Rn=W({__name:"LineageBuilderToolbar",props:{config:{type:Object,required:!0},tree:{type:Object,required:!0}},emits:["addParents","switchParents","unselectAll","displayNames","displayCodes","randomizeLabels","deleteAncestors","importTree","changeBreed","selectCriteria","fullscreen","undo","redo","updateConfig"],setup(e,{emit:n}){const t=_(),o=_(),l=_(),r=_(!1),s=_(!1),i=Ge();mt(l,m=>{const c=m[0];r.value=c.target.clientWidth===l.value.scrollWidth});const a=le([{title:"Export dragon",icon:"save",label:"Export",click:()=>v.showExportDialog=!0},{title:"Import dragon",icon:"file-code",label:"Import",click:()=>v.showImportDialog=!0},{title:"Get Link",icon:"link",label:"Get Link",click:()=>v.showGenerateDialog=!0},{title:"Toggle fullscreen",icon:"maximize",label:"Fullscreen",click:()=>w("fullscreen")},{title:"Undo",icon:"undo",label:"Undo",click:()=>w("undo"),disabled:I(()=>!i.treeHistory.canUndo)},{title:"Redo",icon:"redo",label:"Redo",click:()=>w("redo"),disabled:I(()=>!i.treeHistory.canRedo)}].map(m=>$(m,"2x"))),u=le([{name:"Labels",buttons:[{title:"Show names",icon:"font",label:"Names",click:()=>w("displayNames")},{title:"Display codes",icon:"italic",label:"Codes",click:()=>w("displayCodes")},{title:"Randomise visible label",icon:"random",label:"Randomise label",click:()=>w("randomizeLabels")}]},{name:"Parents",buttons:[{title:"Delete Parents and Ancestors",icon:"minus",label:"Delete Parents",click:()=>w("deleteAncestors")},{title:"Add parents",icon:"arrow-right",label:"Add parents",click:()=>w("addParents")},{title:"Switch parents",icon:"sync-alt",label:"switch parents",click:()=>w("switchParents")}]}].map(m=>({name:m.name,buttons:m.buttons.map(c=>$(c,"1x"))}))),p=le([{label:"All with code",key:"display",criteria:1},{label:"All with name",key:"display",criteria:0},{label:"All with placeholder",key:"breed",criteria:"Placeholder"}]),v=le({showImportDialog:!1,showExportDialog:!1,showGenerateDialog:!1}),w=n,D=m=>{let c=!1,M=!1;return m.every(g=>{g.selected&&(g.gender==="m"?c=!0:g.gender==="f"&&(M=!0))}),{male:c,female:M}},T=_(gt.name),S=I(()=>i.selectionCount),B=I(()=>{if(!S.value)return[];const{male:m,female:c}=D(i.activeLineage),M=Ft(vt,It(Nt)),g=F=>F.name,O=ht.map(g),_e=bt.map(g);let Se;const de=(F,ot)=>F.includes(ot);return m&&c?Se=F=>de(O,F.name)&&de(_e,F.name):Se=m?F=>de(O,F.name):F=>de(_e,F.name),M.filter(Se).map(F=>F.name)});function k(m){w("importTree",m)}function f(){l.value.scrollLeft=0}function b(){l.value.scrollLeft=l.value.scrollWidth}function y(m,c){w("updateConfig",m,c)}function $(m,c="2x"){return{...m,title:H(m.title),label:H(m.label),icon:{size:c,icon:m.icon}}}function H(m){return m.split(" ").map(c=>c[0].toUpperCase()+c.slice(1)).join(" ")}return(m,c)=>{const M=wt("dragscroll");return x(),R(U,null,[C(At,{id:"dialog-export",open:v.showExportDialog,tree:e.tree,onClose:c[0]||(c[0]=g=>v.showExportDialog=!1)},null,8,["open","tree"]),C(Ut,{id:"dialog-import",open:v.showImportDialog,onClose:c[1]||(c[1]=g=>v.showImportDialog=!1),onOnImport:k},null,8,["open"]),C(Ot,{id:"dialog-generate",open:v.showGenerateDialog,tree:e.tree,onClose:c[2]||(c[2]=g=>v.showGenerateDialog=!1)},null,8,["open","tree"]),d("div",ie({ref_key:"toolbar",ref:t,class:"toolbar",role:"toolbar"},m.$attrs),[d("div",Sn,[d("input",{id:"show-interface",checked:e.config.showInterface,class:"item",type:"checkbox",onChange:c[3]||(c[3]=g=>y("showInterface",g.target.checked))},null,40,xn),c[17]||(c[17]=d("label",{for:"show-interface"},"Show controls",-1)),d("input",{id:"show-labels",checked:e.config.showLabels,class:"item",type:"checkbox",onChange:c[4]||(c[4]=g=>y("showLabels",g.target.checked))},null,40,Cn),c[18]||(c[18]=d("label",{for:"show-labels"},"Show labels",-1))]),d("div",kn,[(x(!0),R(U,null,oe(a,g=>(x(),N(J,ie({key:g.label,ref_for:!0},g,{onClick:g.click}),null,16,["onClick"]))),128)),C(He,{icon:{icon:"cog",size:"2x"},title:"Settings",label:"Settings"},{default:L(()=>[C(Ce,{as:"div",onClick:c[6]||(c[6]=g=>y("showInterface",!e.config.showInterface))},{default:L(()=>[d("input",{id:"show-interface2",checked:e.config.showInterface,type:"checkbox"},null,8,Dn),d("label",{for:"show-interface2",onClick:c[5]||(c[5]=re(()=>{},["prevent"]))},"Show controls")]),_:1}),C(Ce,{as:"div",onClick:c[8]||(c[8]=g=>y("showLabels",!e.config.showLabels))},{default:L(()=>[d("input",{id:"show-labels2",checked:e.config.showLabels,type:"checkbox"},null,8,Tn),d("label",{for:"show-labels2",onClick:c[7]||(c[7]=re(()=>{},["prevent"]))},"Show labels")]),_:1})]),_:1})]),d("div",{class:xe(["selection-tools",{"full-width":r.value}]),"aria-label":"Selection toolbar"},[d("button",{class:xe(["selection-nav left",{invisible:r.value}]),type:"button",title:"Scroll to start",onClick:f},null,2),te((x(),R("div",{ref_key:"selectionToolsScrollArea",ref:l,class:"selection-scrollable",onDragscrollstart:c[15]||(c[15]=g=>s.value=!0),onDragscrollend:c[16]||(c[16]=g=>s.value=!1)},[C(ke,null,{legend:L(()=>c[19]||(c[19]=[K("Select")])),default:L(()=>[C(J,{title:"Select all males",icon:{icon:"mars"},onClick:c[9]||(c[9]=g=>w("selectCriteria","gender","m"))}),C(J,{icon:{icon:"venus"},title:"Select all females",onClick:c[10]||(c[10]=g=>w("selectCriteria","gender","f"))}),C(He,{title:"More options",icon:{icon:"caret-down"}},{default:L(()=>[(x(!0),R(U,null,oe(p,g=>(x(),N(Ce,{key:g.key,onClick:O=>w("selectCriteria",g.key,g.criteria)},{default:L(()=>[K(fe(g.label),1)]),_:2},1032,["onClick"]))),128))]),_:1}),C(J,{title:"Unselect all",icon:{icon:"times"},disabled:S.value===0,onClick:c[11]||(c[11]=g=>w("unselectAll"))},null,8,["disabled"])]),_:1}),C(ke,null,{legend:L(()=>c[21]||(c[21]=[K("Breed")])),default:L(()=>[d("div",$n,[te(d("select",{id:"selection-apply-breed",ref_key:"breedSelector",ref:o,"onUpdate:modelValue":c[12]||(c[12]=g=>T.value=g),title:"Apply selected breed",class:"breed-dropdown interactive","data-no-dragscroll":"",disabled:S.value===0,"aria-labelledby":"selection-apply-breed selection-apply-count ",onChange:c[13]||(c[13]=g=>w("changeBreed",T.value))},[(x(!0),R(U,null,oe(B.value,g=>(x(),R("option",{key:g},fe(g),1))),128))],40,Ln),[[yt,T.value]]),d("span",{id:"selection-apply-count",title:"Dragons selected",class:"count",onClick:c[14]||(c[14]=g=>{var O;return(O=o.value)==null?void 0:O.focus()})},[K(fe(S.value),1),c[20]||(c[20]=d("span",{class:"sr-only"},"selected",-1))])])]),_:1}),(x(!0),R(U,null,oe(u,g=>(x(),N(ke,{key:g.name},{legend:L(()=>[K(fe(g.name),1)]),default:L(()=>[(x(!0),R(U,null,oe(g.buttons,O=>(x(),N(J,ie({key:O.label,ref_for:!0},O,{disabled:S.value===0,onClick:O.click}),null,16,["disabled","onClick"]))),128))]),_:2},1024))),128))],32)),[[M,void 0,void 0,{x:!0}]]),d("button",{class:xe(["selection-nav right",{invisible:r.value}]),type:"button",title:"Scroll to end",onClick:b},null,2)],2)],16)],64)}}}),_n=q(Rn,[["__scopeId","data-v-ca08eb55"]]),Bn={class:"dialog-inner"},En={class:"dialog-header"},Fn={id:"dialog-breed-selector-wrapper",class:"dialog-header-title"},In={class:"dialog-buttons"},An={class:"dialog-main"},On=W({__name:"DialogBreedSelectorWrapper",setup(e){const n=Ke();return(t,o)=>{const l=St("FontAwesomeIcon");return x(),R("dialog",{id:"breed-selector-wrapper",ref:h(n).dialogRef,class:"dialog no-transition","aria-labelledby":"dialog-breed-selector-wrapper",onClick:o[1]||(o[1]=r=>{var s;h(n).dialogRef.value&&((s=r.target)!=null&&s.isSameNode(h(n).dialogRef.value))&&h(n).hide()})},[d("div",Bn,[d("header",En,[d("h1",Fn,[ee(t.$slots,"title",{},()=>[o[2]||(o[2]=K("Choose a breed"))],!0)]),d("div",In,[d("button",{class:"button close-button",type:"button",title:"Close",onClick:o[0]||(o[0]=r=>h(n).hide())},[C(l,{size:"2x",icon:"times"})])])]),d("main",An,[ee(t.$slots,"content",{},void 0,!0)])])],512)}}}),Nn=q(On,[["__scopeId","data-v-83d610bf"]]),Vn={class:"date-filter"},Mn={class:"date-filter-header"},Pn={class:"date-inputs"},Wn={class:"date-input-group"},zn={class:"date-input-group"},Hn=W({__name:"DateRangeFilter",setup(e){return(n,t)=>(x(),R("div",Vn,[d("div",Mn,[t[3]||(t[3]=d("h3",null,"Release Date Filter",-1)),h(Vt)()?(x(),R("button",{key:0,type:"button",class:"clear-dates",title:"Clear date filter",onClick:t[0]||(t[0]=(...o)=>h(Ae)&&h(Ae)(...o))}," Clear ")):ae("",!0)]),d("div",Pn,[d("div",Wn,[t[4]||(t[4]=d("label",{for:"start-date"},"From",-1)),te(d("input",{id:"start-date","onUpdate:modelValue":t[1]||(t[1]=o=>h(ge).startDate=o),type:"date",class:"date-input",placeholder:"Start date"},null,512),[[Be,h(ge).startDate]])]),d("div",zn,[t[5]||(t[5]=d("label",{for:"end-date"},"To",-1)),te(d("input",{id:"end-date","onUpdate:modelValue":t[2]||(t[2]=o=>h(ge).endDate=o),type:"date",class:"date-input",placeholder:"End date"},null,512),[[Be,h(ge).endDate]])])]),t[6]||(t[6]=d("div",{class:"date-filter-help"},[d("p",null," Leave start date empty to filter breeds released before the end date. Leave end date empty to filter breeds released after the start date. ")],-1))]))}}),Un=q(Hn,[["__scopeId","data-v-8dc23da3"]]),Gn={id:"filtering"},jn=W({__name:"DialogBreedSelector",emits:["breedSelected"],setup(e,{emit:n}){const t=n,o=xt("search",""),l=he("mateSearchEl"),r=he("resultsEl"),s=Ke();Ct(()=>{l.value&&document.activeElement!==l.value.$el&&l.value.$el.focus()}),se(s.autofocus,async u=>{await De(),u&&l.value&&l.value.$el.focus()});function i(u){var v;const p=parseInt(((v=s.dialogRef.value)==null?void 0:v.dataset.openTime)??"0");Date.now()-p<250||(s.handleBreedSelected(u),t("breedSelected",u))}async function a(){var u;await De(),r.value&&((u=r.value.querySelector("[tabindex='-1'], .breed-entry-button, .grid-cell"))==null||u.focus())}return(u,p)=>(x(),N(Nn,{onClose:p[3]||(p[3]=v=>h(s).hide())},{content:L(()=>[d("form",{role:"search",onSubmit:p[1]||(p[1]=re(v=>a(),["prevent"])),onKeydown:p[2]||(p[2]=Ue(re(v=>a(),["prevent"]),["enter"]))},[p[6]||(p[6]=d("h2",{class:"sr-only"},"Filtering",-1)),d("div",Gn,[C(Mt,{id:"results-search",ref_key:"mateSearchEl",ref:l,modelValue:h(o),"onUpdate:modelValue":p[0]||(p[0]=v=>kt(o)?o.value=v:null),placeholder:"Search",enterkeyhint:"search"},null,8,["modelValue"]),p[4]||(p[4]=d("label",{for:"results-search",class:"sr-only"}," Search ",-1)),p[5]||(p[5]=d("label",{for:"applied-filters",class:"sr-only"}," Filters ",-1)),C(Pt,{id:"applied-filters",placeholder:"Filters",container:"#breed-selector-wrapper"}),C(Un)])],32),d("section",{id:"breeds",ref_key:"resultsEl",ref:r},[p[7]||(p[7]=d("h2",{class:"sr-only"},"Results",-1)),te(C(Ne,{id:"filtered-breeds",search:h(o),breeds:h(Fe)("m"),tags:h(Oe),"no-results-text":"There are no breeds that match this criteria.",onBreedSelected:i},null,8,["search","breeds","tags"]),[[Ee,h(s).forGender.value==="m"]]),te(C(Ne,{id:"filtered-breeds",search:h(o),breeds:h(Fe)("f"),tags:h(Oe),"no-results-text":"There are no breeds that match this criteria.",onBreedSelected:i},null,8,["search","breeds","tags"]),[[Ee,h(s).forGender.value==="f"]])],512)]),_:1}))}}),qn=q(jn,[["__scopeId","data-v-6bcc0634"]]),Kn={class:"constrain-width"},Xn=W({__name:"LineageBuilder",setup(e){const n=Dt(),t=Ge(),o=_(null),l=Tt(o),r=le({showInterface:!0,showLabels:!0,disabled:!1}),s=he("status");$t(async()=>{var b;if(!s.value)return;const f=n.query.template;if(f!==void 0)try{s.value.info({message:"Loading template... For big lineages, this can take a moment to load.",showDismiss:!1});const y=await Lt(f);s.value.close(()=>{t.activeTree=ve(y.lineage).withMetadata().raw()})}catch(y){if(y instanceof Rt&&((b=y.response)==null?void 0:b.status)===404){s.value.error("The lineage couldn't be found.");return}s.value.error("Sorry, an error has occurred.")}}),_t(()=>{t.treeHistory.clear()});function i(f){t.activeTree=t.activeLineage.every(f)}function a(f,b){if(typeof f=="string"){const y=f.toString();t.activeTree=t.activeLineage.every($=>{$.selected&&y in $&&($[y]=b)})}else if(typeof f=="function"){const y=f;t.activeTree=t.activeLineage.every($=>{$.selected&&y($)})}}function u(f,b){if(typeof f=="string"){const y=f.toString();k($=>$[y]===b)}else typeof f=="function"&&k(f)}function p(f){i(b=>{b.selected&&(b.breed=f)})}function v(){a("parents",{})}function w(){a(f=>{Ie(f)||(f.parents={m:pe.createWithMetadata({gender:"m"}),f:pe.createWithMetadata({gender:"f"})})})}function D(){a(f=>{Ie(f)&&Object.assign(f,ve(f).switchParents().raw())})}function T(){a(f=>{f.display===0?f.name=pe.generateName():f.code=pe.generateCode()})}function S(f){a("display",f)}function B(){a("selected",!1)}function k(f){i(b=>{!b.selected&&f(b)&&(b.selected=!0)})}return(f,b)=>(x(),R("div",{ref_key:"builder",ref:o,class:"builder-container"},[C(qn),d("div",Kn,[C(qe,{ref_key:"status",ref:s},null,512)]),h(t).activeTree!==null?(x(),N(zt,{key:0,class:"builder",root:h(t).activeTree,config:r,onContextmenu:()=>!1},null,8,["root","config"])):ae("",!0),h(t).activeTree!==null?(x(),N(_n,{key:1,config:r,tree:h(t).activeTree,onUpdateConfig:b[0]||(b[0]=(y,$)=>r[y]=$),onImportTree:b[1]||(b[1]=y=>h(t).activeTree=h(ve)(y).withMetadata().tree),onUnselectAll:B,onChangeBreed:p,onDisplayNames:b[2]||(b[2]=y=>S(0)),onDisplayCodes:b[3]||(b[3]=y=>S(1)),onSelectCriteria:u,onRandomizeLabels:T,onDeleteAncestors:v,onAddParents:w,onSwitchParents:D,onFullscreen:h(l).toggle,onUndo:h(t).treeHistory.undo,onRedo:h(t).treeHistory.redo},null,8,["config","tree","onFullscreen","onUndo","onRedo"])):ae("",!0)],512))}}),Yn=q(Xn,[["__scopeId","data-v-a912f2e7"]]),lo=W({__name:"Builder",setup(e){return(n,t)=>(x(),R(U,null,[t[0]||(t[0]=d("h1",{class:"sr-only"},"Build",-1)),C(Yn)],64))}});export{lo as default};
